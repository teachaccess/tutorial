import { EditorView, basicSetup } from "@codemirror/basic-setup";
import { EditorState, Compartment } from "@codemirror/state";
import { htmlLanguage, html } from "@codemirror/lang-html";
import { language } from "@codemirror/language";
import { javascript } from "@codemirror/lang-javascript";
import { Helmet } from "react-helmet";
import parse from "html-react-parser";
const languageConf = new Compartment();

export const Editor = () => {
  const [view, setView] = React.useState();
  React.useEffect(() => {
    const editorView = new EditorView({
      state: EditorState.create({
        doc: '<div class="A fake heading">A fake heading</div>',
        extensions: [
          basicSetup,
          html(),
          EditorView.updateListener.of((v) => {
            if (v.docChanged) {
              console.log("DO SOMETHING WITH THE NEW CODE");
            }
          }),
        ],
      }),
      parent: document.querySelector("#editor"),
    });
    setView(editorView);
  }, []);
  const htmlOutput = view?.state.doc.toString() || "";
  return (
    <div>
      <div id="editor"></div>
      <div id="html-output">{parse(htmlOutput)}</div>
    </div>
  );
};
